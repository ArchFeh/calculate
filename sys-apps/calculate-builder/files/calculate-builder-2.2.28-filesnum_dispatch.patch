commit ad97bc7e47e9d160446b4cb5dd4675a4dd2bb6a0
Author: Mike Hiretsky <mh@calculate.ru>
Date:   Fri May 11 16:31:46 2012 +0400

    Add filesnum variable for image

diff --git a/pym/cl_builder.py b/pym/cl_builder.py
index d84e542..d6477c7 100644
--- a/pym/cl_builder.py
+++ b/pym/cl_builder.py
@@ -14,7 +14,7 @@
 #  See the License for the specific language governing permissions and
 #  limitations under the License.
 
-__version__ = "2.2.28"
+__version__ = "2.2.28.1"
 __app__ = "calculate-builder"
 
 import os
diff --git a/pym/cl_fill_builder.py b/pym/cl_fill_builder.py
index 00ce478..fbaf6df 100644
--- a/pym/cl_fill_builder.py
+++ b/pym/cl_fill_builder.py
@@ -23,7 +23,7 @@ from os import access, R_OK,W_OK
 from os import path
 from cl_distr import Distributive
 from cl_utils import getTupleVersion,genpassword,pathJoin,_toUNICODE, \
-                     getFilesCount,getCmdLineParam
+                     getFilesCount,getCmdLineParam,countFiles
 from operator import itemgetter
 from types import ListType
 from cl_datavars import iniParser
@@ -276,6 +276,11 @@ class fillVars(object, varsShare):
                self.detectOtherShortname(systemRoot) or \
                "Linux"
 
+    def get_os_builder_linux_filesnum(self):
+        """Files number in image system"""
+        systemRoot = self.Get('cl_builder_path')
+        return str(countFiles(systemRoot))
+
     def get_os_builder_linux_ver(self):
         """Build system ver"""
         linuxShortName = self.Get("os_builder_linux_shortname")
diff --git a/pym/cl_vars_builder.py b/pym/cl_vars_builder.py
index 8be43e7..44e4965 100644
--- a/pym/cl_vars_builder.py
+++ b/pym/cl_vars_builder.py
@@ -117,6 +117,9 @@ class Data:
     # build system build
     os_builder_linux_build = {'mode':'r','value':''}
 
+    # filesnum in build system
+    os_builder_linux_filesnum = {'mode':'r'}
+
     # build system arch
     os_builder_arch_machine = {}
 
