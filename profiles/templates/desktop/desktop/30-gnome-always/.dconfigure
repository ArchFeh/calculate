# Calculate path=~ name=.dconfigure chmod=700 append=after pkg(gnome-base/gnome-core-libs)!=
#!/bin/bash

wait_dbus() {
    for waittime in {0..10};
    do
        gdbus introspect -e -d org.gnome.Shell -o /org/gnome/Shell &>/dev/null && return
        sleep 1
    done
}

change_params() {
    wait_dbus
#?env(client.os_remote_auth)==||ur_domain_set==off#
    gdbus call -e -d org.gnome.Shell --object-path /org/gnome/Shell -m org.gnome.Shell.DisableExtension "Shut_Down_Menu@rmy.pobox.com"
    gdbus call -e -d org.gnome.Shell --object-path /org/gnome/Shell -m org.gnome.Shell.DisableExtension "remove_shutdown@calculate-linux.org"
#env#
#?env(client.os_remote_auth)!=&&ur_domain_set==on#
    gdbus call -e -d org.gnome.Shell --object-path /org/gnome/Shell -m org.gnome.Shell.EnableExtension "Shut_Down_Menu@rmy.pobox.com"
    gdbus call -e -d org.gnome.Shell --object-path /org/gnome/Shell -m org.gnome.Shell.EnableExtension "remove_shutdown@calculate-linux.org"
#env#
}

#?env(client.os_remote_auth)==||ur_domain_set==off#
dconf write /org/gnome/org/gnome/nautilus/desktop/home-icon-visible true
#env#
#?env(client.os_remote_auth)!=&&ur_domain_set==on#
dconf write /org/gnome/org/gnome/nautilus/desktop/home-icon-visible false
#env#
change_params &

rm ~/.dconfigure
